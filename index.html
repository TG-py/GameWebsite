<!DOCTYPE html>
<html>
    <head>
        <title>Game</title>
        <script src="https://pixijs.download/release/pixi.js"></script>
    </head>

    <body>
        <script type="module">
            const keyMap = {
            KeyA: `left`,
            KeyD: `right`
            }

            export class Controller
            {
                constructor()
                {
                    this.keys = {
                        left: false,
                        right: false
                    };

                    window.addEventListener(`keydown`, (event) => this.keydownHandler(event));
                    window.addEventListener(`keyup`, (event) => this.keyupHandler(event));
                }

                keydownHandler(event)
                {
                    const key = keyMap[event.code];

                    if (!key) return;

                    this.keys[key] = true;
                }

                keyupHandler(event)
                {
                    const key = keyMap[event.code];

                    if (!key) return;

                    this.keys[key] = false;
                }
            }

            const app = new PIXI.Application();
            await app.init({ background: `#1099bb`, width: window.innerWidth-22, height: window.innerHeight-22});

            document.body.appendChild(app.canvas);

            await PIXI.Assets.load('https://pixijs.com/assets/files/sample-747abf529b135a1f549dff3ec846afbc.png');
            let sprite = PIXI.Sprite.from('https://pixijs.com/assets/files/sample-747abf529b135a1f549dff3ec846afbc.png');

            const controller = new Controller();

            app.stage.addChild(sprite);
            
            sprite.anchor.set(0.5);

            sprite.x = app.screen.width *0.5;
            sprite.y = app.screen.height *0.85;

            var shipPos = 0.5
            
            app.ticker.add(() =>
            {
                const moveSpeed = 0.01

                if (controller.keys.left) shipPos -= moveSpeed
                else if (controller.keys.right) shipPos += moveSpeed

                sprite.x = app.screen.width *shipPos;
            });
        </script>
    </body>
</html>
